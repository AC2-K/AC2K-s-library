# BabyStepGiantStep(BSGS)

集合 $S$ ,写像 $f:S\to S$ , $s,g\in S$ に対して、以下を満たす最小の非負整数 $t$ を求めます。
$$f^t(s)=g$$

ただし、以下の条件を満たす必要があります。 $f^i$ みたいなのは、 $f$ の $i$ 回合成です。
- ある $n\in\mathbb{N}$ が存在して、任意の $x\in S$ に対して $f^n(x)=x$ が成り立つ。
- 逆写像 $f^{-1}$ が存在する
- ある $m\in\mathbb{N}$が存在して $f^m$ が高速に求まる。

このとき、 $n,m,f^m$ が実際に求まれば、上記の $t$ が $O((m+\frac{n}{m})\log m)$ で求まる。\
$m=\text{ceil}(\sqrt n)$ だと計算量 $(\sqrt n\log n)$で求まる!!!

<details>
  <summary> 手法 </summary>
  
  $t=0,1,\dots,n$ に対して確かめればいいです。\
  まず、別処理で $t=0$ の時を調べておきます。これは $s=g$かどうか判定するだけです。
  \
  \
  $t=im-j$ と分解します。この時、 $1\leq i\leq n/m$ と $0\leq j< m$ が成り立つと仮定して良いです。このとき、
  $$f^{im-j}(s)=g$$
  かどうか判定します。これは、
  $$f^{im}(s)=f^{j}(g)$$
  と変形できて、
  $$(f^m)^{i}(s)=f^{j}(g)$$
  となります。ここで、 $i$ を固定してみることにします。このとき、 $t$ を最小化するためには $f^{im}(s)=f^{j}(g)$ なる最大の $j$ を使えばよいです。                      
</details>
